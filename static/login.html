<!DOCTYPE html>

<head>
  <title>miajio-登录</title>
  <link rel="stylesheet" type="text/css" href="/static/css/home.css" />
  <script src="/static/js/jquery-3.6.4.min.js"></script>
  <script src="/static/js/cookie.js"></script>
</head>

<body>
  <div class="container">
    <h1>登录</h1>
      <input type="text" placeholder="用户名" name="username" id="username-input" required>
      <input type="password" placeholder="密码" name="password" id="password-input" required>
      <button type="submit" id="login-button">登录</button>
      <a href="/register.html">注册</a>
  </div>
  <script>
    $(function() {
      $("#login-button").click(function() {
        var data = new FormData()
        data.append("username", $("#username-input").val())
        data.append("password", $("#password-input").val())

        $.ajax({
          url: "/user/login",
          type: "POST",
          data: data,
          cache: false,
          processData: false,
          contentType: false,
          success: function(data) {
            if (data.code == 200 && data.data != "") {
              setCookie("uid", data.data, 5)
              window.location.replace("/index.html")
            } else {
              window.location.replace("/error?code="+data.code+"&msg="+data.msg+"&err="+data.error)
            }
          }
        })
      });
    })
  </script>
</body>

</html>